---
output:
  github_document:
    md_extensions: "+ignore_line_breaks"
    pandoc_args: "--atx-headers"
---

# 第5章 統計的仮説検定

## 5.3 標準正規分布を用いた検定

```{r}
心理学テスト <- c(13,14,7,12,10,6,8,15,4,14,9,6,10,12,5,12,8,8,12,15)
Z統計量 <- (mean(心理学テスト)-12) / sqrt(10/length(心理学テスト))
Z統計量
```

```{r}
qnorm(0.025)
qnorm(0.025,lower.tail=FALSE)
```

```{r}
curve(dnorm(x),-3,3)
abline(v=qnorm(0.025))
abline(v=qnorm(0.975))
```

p値を求める

```{r}
2*pnorm(2.828427,lower.tail=FALSE)
```

有意水準0.05よりも小さいので、帰無仮説は棄却される。

## 5.4 t分布を用いた検定

```{r}
t統計量 <- (mean(心理学テスト)-12) / sqrt(var(心理学テスト)/length(心理学テスト))
t統計量
```

p値

```{r}
2*pt(2.616648,19,lower.tail=FALSE)
```

```{r}
t.test(心理学テスト,mu=12)
```

## 5.5 相関係数の検定

```{r}

統計テスト1 <- c(6,10,6,10,5,3,5,9,3,3,11,6,11,9,7,5,8,7,7,9)
統計テスト2 <- c(10,13,8,15,8,6,9,10,7,3,18,14,18,11,12,5,7,12,7,7)
```

```{r}
標本相関 <- cor(統計テスト1, 統計テスト2)
サンプルサイズ <- length(統計テスト1)
t統計量 <- 標本相関*sqrt(サンプルサイズ-2) / sqrt(1-標本相関^2)
t統計量
```

p値

```{r}
2*pt(4.805707,18,lower.tail=FALSE)
```

## 5.6 独立性の検定

```{r}
数学 <- c("嫌い","嫌い","好き","好き","嫌い","嫌い","嫌い","嫌い","嫌い","好き","好き","嫌い","好き","嫌い","嫌い","好き","嫌い","嫌い","嫌い","嫌い")
統計 <- c("好き","好き","好き","好き","嫌い","嫌い","嫌い","嫌い","嫌い","嫌い","好き","好き","好き","嫌い","好き","嫌い","嫌い","嫌い","嫌い","嫌い")
table(数学,統計)
```

```{r}
期待度数 <- c(12*14/20, 12*6/20, 8*14/20, 8*6/20)
観測度数 <- c(10,2,4,4)
カイ二乗 <- sum((観測度数-期待度数)^2/期待度数)
カイ二乗
```

p値

```{r}
pchisq(2.539683,1,lower.tail=FALSE)
```
