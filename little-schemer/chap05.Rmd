---
output:
  github_document:
    md_extensions: "+ignore_line_breaks"
---

# 5章 \*すごい\*星がいっぱいだ

```{r setup, include=FALSE}
library(knitscm)
gosh_path <- system2("which", "gosh", stdout = TRUE)
handle <- knitscm::run_scheme(gosh_path, "-i")
knitr::opts_chunk$set(handle = handle)
```

```{scm include=FALSE}
(load "./little.scm")
```

関数`rember*`

```{scm results=FALSE}
(define rember*
  (lambda (a l)
    (cond
     ((null? l) (quote ()))
     ((atom? (car l))
      (cond
       ((eq? (car l) a)
        (rember* a (cdr l)))
       (else
        (cons (car l) (rember* a (cdr l))))))
     (else
      (cons (rember* a (car l))
            (rember* a (cdr l)))))))
```

```{scm}
(rember* 'cup '((coffee) cup ((tea) cup) (and (hick)) cup))
```

関数`insertR*`

```{scm results=FALSE}
(define insertR*
  (lambda (new old l)
    (cond
     ((null? l) (quote ()))
     ((atom? (car l))
      (cond
       ((eq? (car l) old)
        (cons (car l)
              (cons new (insertR* new old (cdr l)))))
       (else
        (cons (car l) (insertR* new old (cdr l))))))
     (else
      (cons (insertR* new old (car l))
            (insertR* new old (cdr l)))))))
```

```{scm}
(insertR* 'roast 'chuck
          '(((how much (wood)) could ((a (wood) chuck))
             (((chuck))) (if (a) ((wood chuck))) could chuck wood)))
```
