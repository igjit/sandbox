---
output:
  github_document:
    md_extensions: "+ignore_line_breaks"
---

# 3章 偉大なるCons

```{r setup, include=FALSE}
devtools::load_all("r/knitscm/")
gosh_path <- system2("which", "gosh", stdout = TRUE)
handle <- knitscm::run_scheme(gosh_path, "-i")
knitr::opts_chunk$set(handle = handle)
```

p.35の未完成な`rember`

```{scm}
(define rember
  (lambda (a lat)
    (cond
     ((null? lat) (quote ()))
     (else (cond
            ((eq? (car lat) a) (cdr lat))
             (else (rember a (cdr lat))))))))
```

baconを除く

```{scm}
(rember 'bacon '(bacon lettuce and tomato))
```

andを除いたときにandの前にある全ての要素を失ってしまう

```{scm}
(rember 'and '(bacon lettuce and tomato))
```

p.38の`rember`

```{scm}
(define rember
  (lambda (a lat)
    (cond
     ((null? lat) (quote ()))
     (else (cond
            ((eq? (car lat) a) (cdr lat))
            (else (cons (car lat)
                        (rember a (cdr lat)))))))))
```

```{scm}
(rember 'and '(bacon lettuce and tomato))
```

p.41の簡単化した`rember`

```{scm}
(define rember
  (lambda (a lat)
    (cond
     ((null? lat) (quote ()))
     ((eq? (car lat) a) (cdr lat))
     (else (cons (car lat)
                 (rember a (cdr lat)))))))
```

```{scm}
(rember 'and '(bacon lettuce and tomato))
```

```{scm}
(rember 'sauce '(soy sauce and tomato sauce))
```

```{r include=FALSE}
knitscm::kill_scheme(handle)
```
